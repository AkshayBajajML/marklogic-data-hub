<flow xmlns="http://marklogic.com/hub-in-a-box">

  <!-- defines 0 or more namespaces used in the paths below -->
  <namespace prefix="e" uri="http://company.com/employee"/>

  <!--
    a collector definition. Collectors gather uris or nodes or whatever
    @module = the name of or path to the collector module to run
    @ns = the namespace of the module
    [@function] = the function to run. defaults to collect
  -->
  <collector module="default-collector">
    <options>
      <!-- <query txt="collection:stuff AND puppies" options="dogs-options"/> -->

      <!-- specify a collection for a collection-query -->
      <collection>
        <!-- one ore more collection uris -->
        <uri>employees</uri>
      </collection>

      <!-- specify a directory for a directory-query -->
      <directory>
        <!-- one ore more directory uris -->
        <uri>/blah/</uri>
        <uri>/blah2/</uri>
        <depth>infinity</depth>
      </directory>
    </options>
  </collector>

  <!-- one or more transformers to run against data -->
  <transformers>

    <!--
      a transformer definition
        @module = the name of or path to the transformer module to run
        @ns = the namespace of the module
        [@function] = the function to run. defaults to transform
    -->
    <transformer module="envelope"
      ns="http://marklogic.com/hub-in-a-box/transformers/envelope"
      function="transform">

      <!-- each transformer has different options -->
      <options>
        <extractor type="xpath" path="/e:employee/e:hire_date[1]" target="hire-date">
          <!-- 0 or more functions to run against the extracted value -->
          <function name="parseDate" format="[M01]/[D01]/[Y0001]"/>
        </extractor>
        <!--
          the template is the outline for the envelope xml
          it lives in /templates/employee-envelope.xml
        -->
        <template name="employee-envelope-xml-source.xml"/>
      </options>
    </transformer>
  </transformers>
</flow>
